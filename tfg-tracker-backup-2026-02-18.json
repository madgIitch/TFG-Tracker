{
  "sprints": [
    {
      "scenarioId": "A",
      "sprintNumber": 7,
      "status": "in_progress",
      "dateStart": "2026-02-18",
      "dateEnd": null,
      "tts": 0.02,
      "description": "",
      "commits": null,
      "filesCreated": null,
      "filesModified": null,
      "testsTotal": null,
      "testsPass": null,
      "testsFail": null,
      "verificationTime": null,
      "manualEdits": null,
      "correctivePrompts": null,
      "rejectedProposals": null,
      "filesReadByAI": null,
      "filesTotalRepo": null,
      "retrievalMechanism": null,
      "autonomousActions": null,
      "controlCheckpoints": null,
      "architecturalCoherence": null,
      "buildsOk": null,
      "buildsTotal": null,
      "envFailures": null,
      "tsWarnings": null,
      "linterWarnings": null,
      "styleConsistency": null,
      "incidences": [],
      "observations": "",
      "createdAt": "2026-02-18T00:20:43.127Z",
      "updatedAt": "2026-02-18T13:18:49.018Z",
      "id": 1,
      "autoCorrectivePrompts": null,
      "autoRejectedProposals": null
    },
    {
      "scenarioId": "B",
      "sprintNumber": 7,
      "status": "pending",
      "dateStart": null,
      "dateEnd": null,
      "tts": null,
      "description": "",
      "commits": null,
      "filesCreated": null,
      "filesModified": null,
      "testsTotal": null,
      "testsPass": null,
      "testsFail": null,
      "verificationTime": null,
      "manualEdits": null,
      "correctivePrompts": null,
      "rejectedProposals": null,
      "filesReadByAI": null,
      "filesTotalRepo": null,
      "retrievalMechanism": null,
      "autonomousActions": null,
      "controlCheckpoints": null,
      "architecturalCoherence": null,
      "buildsOk": null,
      "buildsTotal": null,
      "envFailures": null,
      "tsWarnings": null,
      "linterWarnings": null,
      "styleConsistency": null,
      "incidences": [],
      "observations": "",
      "createdAt": "2026-02-18T00:23:35.772Z",
      "updatedAt": "2026-02-18T00:23:37.281Z",
      "id": 2
    }
  ],
  "scenarios": [
    {
      "scenarioId": "A",
      "acceptanceChecklist": {
        "sprint7": false,
        "sprint8": false,
        "sprint9": false,
        "sprint10": false,
        "sprint11": false,
        "sprint12": false,
        "sprint13": false,
        "sprint14": false,
        "sprint15": false,
        "sprint16": false,
        "sprint17": false,
        "sprint18": false,
        "sprint19": false,
        "sprint20": false,
        "sprint21": false,
        "sprint22": false,
        "sprint23": false,
        "functionalParity": false
      },
      "narrative": {
        "strengths": "",
        "weaknesses": "",
        "generalExperience": ""
      },
      "updatedAt": "2026-02-18T02:28:14.675Z",
      "id": 1
    },
    {
      "scenarioId": "B",
      "acceptanceChecklist": {
        "sprint7": false,
        "sprint8": false,
        "sprint9": false,
        "sprint10": false,
        "sprint11": false,
        "sprint12": false,
        "sprint13": false,
        "sprint14": false,
        "sprint15": false,
        "sprint16": false,
        "sprint17": false,
        "sprint18": false,
        "sprint19": false,
        "sprint20": false,
        "sprint21": false,
        "sprint22": false,
        "sprint23": false,
        "functionalParity": false
      },
      "narrative": {
        "strengths": "",
        "weaknesses": "",
        "generalExperience": ""
      },
      "updatedAt": "2026-02-18T00:23:35.768Z",
      "id": 2
    },
    {
      "scenarioId": "C",
      "acceptanceChecklist": {
        "sprint7": false,
        "sprint8": false,
        "sprint9": false,
        "sprint10": false,
        "sprint11": false,
        "sprint12": false,
        "sprint13": false,
        "sprint14": false,
        "sprint15": false,
        "sprint16": false,
        "sprint17": false,
        "sprint18": false,
        "sprint19": false,
        "sprint20": false,
        "sprint21": false,
        "sprint22": false,
        "sprint23": false,
        "functionalParity": false
      },
      "narrative": {
        "strengths": "",
        "weaknesses": "",
        "generalExperience": ""
      },
      "updatedAt": "2026-02-18T00:14:44.745Z",
      "id": 3
    },
    {
      "scenarioId": "D",
      "acceptanceChecklist": {
        "sprint7": false,
        "sprint8": false,
        "sprint9": false,
        "sprint10": false,
        "sprint11": false,
        "sprint12": false,
        "sprint13": false,
        "sprint14": false,
        "sprint15": false,
        "sprint16": false,
        "sprint17": false,
        "sprint18": false,
        "sprint19": false,
        "sprint20": false,
        "sprint21": false,
        "sprint22": false,
        "sprint23": false,
        "functionalParity": false
      },
      "narrative": {
        "strengths": "",
        "weaknesses": "",
        "generalExperience": ""
      },
      "updatedAt": "2026-02-18T00:23:40.988Z",
      "id": 4
    }
  ],
  "prompts": [
    {
      "title": "Sprint 7 ‚Äî Sistema de Gesti√≥n de Gastos",
      "content": "Implementa un sistema completo de gesti√≥n de gastos compartidos para pisos en HomiMatchApp.\n\nLo que debes crear:\n\nPantalla FlatExpensesScreen: lista de gastos del piso con creaci√≥n de nuevos gastos. Cada gasto tiene: descripci√≥n, importe total, pagador (uno de los compa√±eros del piso), y distribuci√≥n entre los miembros del piso. Usa el estilo glassmorphism existente.\n\nPantalla FlatSettlementScreen: resumen de liquidaciones entre compa√±eros. Calcula autom√°ticamente qui√©n le debe cu√°nto a qui√©n y permite marcar deudas como saldadas.\n\nServicio flatExpenseService: funciones CRUD para gastos. Un gasto tiene campos: id, flat_id, description, amount, paid_by (user_id), split_between (array de user_ids), created_at. Los splits pueden ser iguales o personalizados.\n\nServicio flatSettlementService: l√≥gica para calcular el balance neto de cada miembro y generar las liquidaciones m√≠nimas necesarias (algoritmo greedy: el que m√°s debe paga al que m√°s se le debe primero).\n\nEdge Functions de Supabase:\n\nflat-expenses: GET (listar gastos del piso) y POST (crear gasto nuevo)\nflat-settlements: GET (calcular liquidaciones pendientes) y POST (marcar como saldado)\nTablas en Supabase:\n\nflat_expenses: id, flat_id, description, amount, paid_by, created_at\nflat_expense_splits: id, expense_id, user_id, amount\nflat_settlements: id, flat_id, from_user, to_user, amount, settled_at\nIntegraci√≥n en navegaci√≥n: a√±ade acceso a estas pantallas desde el tab de gesti√≥n del piso (RoomManagementScreen).\n\nRestricciones t√©cnicas:\n\nSolo los miembros del piso pueden ver y crear gastos\nEl c√°lculo de deudas debe actualizarse autom√°ticamente al a√±adir un gasto o liquidar\nLos imports de Supabase usan el cliente configurado globalmente en src/lib/supabase.ts\nSigue el patr√≥n de los servicios existentes (async/await, tipado con interfaces TypeScript)",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:22:38.558Z",
      "updatedAt": "2026-02-18T13:23:11.183Z",
      "id": 2
    },
    {
      "title": "Sprint 8 ‚Äî Correcciones UI/UX",
      "content": "Corrige los problemas visuales y de experiencia detectados en la v0 de HomiMatchApp.\n\nFixes a realizar:\n\nLoginScreen: ajusta el layout para que funcione correctamente cuando el teclado est√° visible. El bot√≥n de login no debe quedar tapado. Revisa el padding inferior y usa KeyboardAvoidingView si es necesario.\n\nRegisterScreen (todas las fases del registro multi-fase): verifica que los inputs no queden ocultos bajo el teclado en ninguna fase. A√±ade scroll si el contenido supera la pantalla.\n\nProfileDetailScreen: corrige los m√°rgenes y espaciados inconsistentes. Las secciones de intereses (chips) deben verse completas sin cortes. Las fotos de perfil deben tener la relaci√≥n de aspecto correcta.\n\nSwipeScreen: corrige el comportamiento de las cards durante el swipe. Si hay renders dobles o flickering al pasar cards, identifica la causa en el estado y corr√≠gela. Aseg√∫rate de que el gesto de swipe no interfiere con los botones de acci√≥n.\n\nOptimizaci√≥n de renders: revisa los componentes que se re-renderizan innecesariamente. Aplica React.memo, useCallback o useMemo donde corresponda para evitar renders en cascada.\n\nErrores visuales generales: repasa todas las pantallas en modo claro buscando textos cortados, overlaps de elementos, o elementos fuera de los l√≠mites de pantalla. Corr√≠gelos con estilos correctos (evita valores hardcodeados en px; usa porcentajes o Dimensions cuando sea necesario).\n\nCriterio de √©xito: la app no debe tener ning√∫n error visual obvio en LoginScreen, RegisterScreen, ProfileDetailScreen ni SwipeScreen al hacer scroll, abrir el teclado, o interactuar con los gestos de swipe.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:23:35.556Z",
      "updatedAt": "2026-02-18T13:23:35.556Z",
      "id": 3
    },
    {
      "title": "Sprint 9 ‚Äî Refactorizaci√≥n v1: Separaci√≥n de Estilos",
      "content": "Refactoriza la capa de estilos de HomiMatchApp separando los estilos inline de los componentes a archivos dedicados, y establece un sistema de tokens de dise√±o.\n\nLo que debes hacer:\n\nCrea la carpeta src/styles/ con la siguiente estructura:\n\nsrc/styles/\n‚îú‚îÄ‚îÄ tokens/\n‚îÇ   ‚îú‚îÄ‚îÄ colors.ts       # paleta de colores y sem√°ntica (primary, surface, text, etc.)\n‚îÇ   ‚îú‚îÄ‚îÄ spacing.ts      # escala de spacing (xs, sm, md, lg, xl, xxl)\n‚îÇ   ‚îî‚îÄ‚îÄ fonts.ts        # tama√±os de fuente y pesos\n‚îú‚îÄ‚îÄ screens/            # estilos de cada pantalla\n‚îÇ   ‚îú‚îÄ‚îÄ LoginScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ RegisterScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ SwipeScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ ProfileDetailScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ ChatScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ MatchesScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ FiltersScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ EditProfileScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ FlatExpensesScreen.styles.ts\n‚îÇ   ‚îú‚îÄ‚îÄ FlatSettlementScreen.styles.ts\n‚îÇ   ‚îî‚îÄ‚îÄ ... (una por cada pantalla existente)\n‚îî‚îÄ‚îÄ common.ts           # estilos reutilizables: containers, cards, inputs, headers\nExtrae los StyleSheets: cada pantalla actualmente tiene su StyleSheet.create inline al final del archivo. Mu√©velo a su archivo .styles.ts correspondiente y haz el import en la pantalla. El archivo de estilos exporta un √∫nico objeto styles por defecto.\n\nAplica tokens: sustituye los valores hardcodeados de colores, spacings y tama√±os de fuente por referencias a los tokens. Ejemplo: en lugar de color: '#FFFFFF' usa colors.white; en lugar de padding: 16 usa spacing.md.\n\ncommon.ts: extrae los estilos repetidos en m√∫ltiples pantallas (por ejemplo, el contenedor base con fondo gradiente, el estilo de bot√≥n primario, el estilo de input) a este archivo y reutil√≠zalos import√°ndolos.\n\nNo cambies la l√≥gica: esta refactorizaci√≥n es puramente estructural. El comportamiento visual debe quedar id√©ntico antes y despu√©s.\n\nResultado esperado: ~50 archivos modificados/creados. El c√≥digo queda m√°s limpio y los estilos son f√°ciles de modificar globalmente cambiando un token.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:24:13.153Z",
      "updatedAt": "2026-02-18T13:24:13.153Z",
      "id": 4
    },
    {
      "title": "Sprint 10 ‚Äî Recuperaci√≥n de Contrase√±as",
      "content": "Implementa el flujo completo de recuperaci√≥n de contrase√±a por email en HomiMatchApp.\n\nLo que debes crear:\n\nForgotPasswordScreen: pantalla accesible desde LoginScreen (enlace \"¬øOlvidaste tu contrase√±a?\"). Tiene un campo de email y un bot√≥n de enviar. Al enviarlo, llama al servicio de recuperaci√≥n y muestra un mensaje de confirmaci√≥n (\"Te hemos enviado un email con las instrucciones\").\n\nResetPasswordScreen: pantalla que se abre cuando el usuario toca el enlace del email de recuperaci√≥n. Tiene dos campos (nueva contrase√±a y confirmaci√≥n) y un bot√≥n de guardar. Valida que ambas contrase√±as coincidan y cumplan los requisitos m√≠nimos.\n\nServicio de recuperaci√≥n (en authService o archivo propio):\n\nsendPasswordResetEmail(email: string): llama a supabase.auth.resetPasswordForEmail() con la URL de redirect correcta\nupdatePassword(newPassword: string): llama a supabase.auth.updateUser({ password: newPassword })\nDeep linking: configura el deep link homimatch://reset-password para que Android e iOS abran ResetPasswordScreen cuando el usuario toca el enlace del email. Configura:\n\nEn Android: AndroidManifest.xml con el intent filter correspondiente\nEn iOS: Info.plist con el URL scheme\nEn el navegador: maneja el par√°metro de sesi√≥n que devuelve Supabase en la URL de reset\nIntegraci√≥n en AppNavigator: a√±ade ForgotPasswordScreen y ResetPasswordScreen al stack de navegaci√≥n de autenticaci√≥n (fuera del flujo autenticado).\n\nTesting del flujo: verifica que el flujo completo funciona: usuario en LoginScreen ‚Üí toca \"¬øOlvidaste tu contrase√±a?\" ‚Üí introduce email ‚Üí recibe email ‚Üí toca enlace ‚Üí abre ResetPasswordScreen ‚Üí introduce nueva contrase√±a ‚Üí vuelve a LoginScreen.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:24:31.144Z",
      "updatedAt": "2026-02-18T13:24:31.144Z",
      "id": 5
    },
    {
      "title": "Sprint 11 ‚Äî Mejoras UI de Detalles",
      "content": "Mejora la interfaz de las pantallas de detalle de perfiles y pisos en HomiMatchApp.\n\nLo que debes hacer:\n\nProfileDetailScreen: redise√±a el layout siguiendo el estilo glassmorphism del resto de la app. La pantalla debe:\n\nMostrar las fotos del perfil en un carrusel con paginaci√≥n (bullets o n√∫meros)\nMostrar el nombre, edad, g√©nero y ciudad en un header flotante sobre la √∫ltima foto\nOrganizar la informaci√≥n en secciones con tarjetas glassmorphism: \"Sobre m√≠\", \"Mis intereses\" (chips), \"Lo que busco\", \"Mi situaci√≥n\" (tiene piso / busca piso)\nLos botones de like/dislike deben estar visibles en la parte inferior sin tapar el contenido\nAseg√∫rate de que el scroll funciona correctamente\nRoomDetailScreen: mejora la presentaci√≥n del piso con:\n\nCarrusel de fotos del piso\nInformaci√≥n clara del piso: direcci√≥n, precio, habitaciones disponibles, servicios incluidos\nSecci√≥n de roommates actuales con sus avatares\nReglas del piso en formato legible\nBot√≥n de contactar / solicitar unirse (seg√∫n el estado del match)\nActualizaci√≥n del tema global: si durante el redise√±o detectas valores de color o spacing que deber√≠an estar en los tokens pero no est√°n, a√±√°delos a los archivos de tokens de src/styles/tokens/.\n\nFlatExpensesScreen (fix menor): corrige cualquier problema visual que exista en la pantalla de gastos (padding, alineaci√≥n, overflow de texto).\n\nRestricci√≥n: no cambies la l√≥gica de negocio ni las llamadas a servicios. Solo modifica la capa de presentaci√≥n.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:24:50.799Z",
      "updatedAt": "2026-02-18T13:24:50.799Z",
      "id": 6
    },
    {
      "title": "Sprint 12 ‚Äî Sistema de Invitaciones",
      "content": "Implementa un sistema de c√≥digos de invitaci√≥n para que los propietarios puedan invitar a compa√±eros a unirse a su piso.\n\nLo que debes crear:\n\nFase 4 del registro (Phase4Invitation): nueva pantalla en el flujo de registro multi-fase. Aparece despu√©s de la fase de g√©nero y pregunta al usuario si tiene un c√≥digo de invitaci√≥n. Dos opciones: \"Tengo un c√≥digo\" (muestra input para introducirlo) y \"No tengo c√≥digo\" (contin√∫a al flujo normal). Si introduce un c√≥digo v√°lido, el usuario queda asociado al piso.\n\nServicio roomInvitationService:\n\ngenerateInviteCode(flatId: string): genera un c√≥digo √∫nico (6-8 caracteres alfanum√©ricos) y lo guarda en Supabase\nvalidateInviteCode(code: string): verifica que el c√≥digo existe, no ha expirado y el piso tiene habitaciones disponibles\njoinFlatWithCode(code: string, userId: string): asocia al usuario al piso, asigna habitaci√≥n disponible, y devuelve los datos del piso\nEdge Function room-invitations:\n\nPOST /generate: genera y devuelve un nuevo c√≥digo para el piso del propietario autenticado\nPOST /join: valida el c√≥digo y une al usuario al piso\nGET /validate/:code: verifica si un c√≥digo es v√°lido sin unirse a√∫n\nTabla room_invitation_codes: id, flat_id, code (√∫nico), created_by, created_at, expires_at (nullable), used_by (nullable), used_at (nullable)\n\nUI en RoomManagementScreen: bot√≥n \"Generar c√≥digo de invitaci√≥n\" que muestra el c√≥digo generado con opci√≥n de copiarlo al portapapeles y compartirlo.\n\nMatches autom√°ticos: cuando un usuario se une a un piso mediante c√≥digo de invitaci√≥n, crea autom√°ticamente registros de match entre √©l y todos los compa√±eros existentes del piso con estado accepted (son compa√±eros, ya se conocen).\n\nRoomDetailScreen: muestra la lista de roommates actuales del piso (nombre + foto).\n\n",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:25:30.894Z",
      "updatedAt": "2026-02-18T13:25:30.894Z",
      "id": 7
    },
    {
      "title": "Sprint 13 ‚Äî Push Notifications",
      "content": "Implementa el sistema completo de notificaciones push en HomiMatchApp usando Firebase Cloud Messaging.\n\nLo que debes crear:\n\nConfiguraci√≥n de Firebase:\n\nIntegra @react-native-firebase/app y @react-native-firebase/messaging\nConfigura google-services.json en Android y GoogleService-Info.plist en iOS\nSolicita permisos de notificaciones al usuario al abrir la app\nServicio pushTokenService:\n\nregisterToken(): obtiene el FCM token del dispositivo y lo guarda en Supabase vinculado al usuario autenticado (push_tokens table: user_id, token, platform, updated_at)\nremoveToken(): elimina el token al hacer logout\nServicio notificationService:\n\nManeja notificaciones en foreground (muestra una notificaci√≥n local si la app est√° abierta)\nManeja notificaciones en background (el handler de FCM se encarga)\nManeja el tap en notificaci√≥n (navegaci√≥n por deep link al contenido relevante)\nExcepci√≥n: si el usuario ya est√° en el chat del que llega la notificaci√≥n, no la muestra\nEdge Functions de Supabase (se llaman desde los triggers de Supabase o desde otras edge functions):\n\npush-new-message: env√≠a push al destinatario cuando llega un mensaje nuevo en el chat\npush-match-status: env√≠a push cuando cambia el estado de un match (nuevo match, rechazo)\npush-flat-expense: env√≠a push a todos los compa√±eros cuando se crea un nuevo gasto\npush-flat-settlement: env√≠a push cuando alguien liquida una deuda\npush-room-assignment: env√≠a push cuando el propietario asigna una habitaci√≥n a un compa√±ero\nDeep linking desde notificaciones: configurar el payload de cada tipo de notificaci√≥n con datos suficientes para navegar directamente al contenido:\n\nMensaje ‚Üí abre ChatScreen del chat correspondiente\nMatch ‚Üí abre MatchesScreen\nGasto ‚Üí abre FlatExpensesScreen\nPermisos Android: configura en AndroidManifest.xml los permisos necesarios para notificaciones y el canal de notificaciones por defecto.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:25:49.912Z",
      "updatedAt": "2026-02-18T13:25:49.912Z",
      "id": 8
    },
    {
      "title": "Sprint 14 ‚Äî Chats en Tiempo Real",
      "content": "Implementa mensajer√≠a en tiempo real y redise√±a la UI del sistema de chat en HomiMatchApp.\n\nLo que debes implementar:\n\nSupabase Realtime en ChatScreen:\n\nSuscr√≠bete al canal de mensajes del chat actual usando supabase.channel() con filtros por chat_id\nCuando llega un mensaje nuevo, a√±√°delo al estado local sin recargar todos los mensajes\nImplementa autoscroll autom√°tico al recibir un mensaje nuevo (si el usuario est√° en el fondo del scroll) o al enviar un mensaje propio\nAl desmontar el componente, cancela la suscripci√≥n\nOrden de chats en MatchesScreen:\n\nLa lista de chats debe ordenarse por el timestamp del √∫ltimo mensaje (m√°s reciente primero)\nMuestra un indicador de mensajes no le√≠dos (punto o n√∫mero) en los chats con mensajes no le√≠dos\nSuscr√≠bete en tiempo real a los cambios en los chats del usuario para que el orden se actualice autom√°ticamente\nRedise√±o de ChatScreen con glassmorphism:\n\nHeader con foto y nombre del contacto, con bot√≥n de volver\nBurbujas de mensaje diferenciadas: las tuyas a la derecha (color primario), las del otro a la izquierda (glassmorphism)\nTimestamps en los mensajes, agrupados por d√≠a (\"Hoy\", \"Ayer\", fecha completa)\nInput de texto en la parte inferior con bot√≥n de enviar, que no tape los mensajes cuando el teclado est√° abierto\nRedise√±o de MatchesScreen:\n\nLista de matches con foto, nombre y √∫ltimo mensaje (preview truncado)\nIndicador de tiempo del √∫ltimo mensaje (hace X min, hace X horas, etc.)\nSecci√≥n separada para nuevos matches sin mensajes a√∫n\nActualizaci√≥n UI de formularios: con el nuevo sistema de estilos y glassmorphism, actualiza la UI de:\n\nEditProfileScreen, CreateFlatScreen, RoomEditScreen, RoomManagementScreen\nFlatExpensesScreen, FlatSettlementScreen\nAseg√∫rate de que todos siguen el mismo lenguaje visual",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:26:08.559Z",
      "updatedAt": "2026-02-18T13:26:08.559Z",
      "id": 9
    },
    {
      "title": "Sprint 15 ‚Äî UI Fix Global",
      "content": "Realiza una correcci√≥n masiva de problemas de UX en todas las pantallas de HomiMatchApp, con foco especial en el comportamiento del teclado y la adaptaci√≥n a distintos tama√±os de pantalla.\n\nLo que debes corregir:\n\nAutoscroll con teclado: en todas las pantallas con formularios, el contenido debe hacer scroll autom√°ticamente para que el campo de input activo no quede tapado por el teclado. Implementa esto de forma consistente en:\n\nTodas las fases del registro (Phase1Email, Phase2Name, Phase3BirthDate, Phase3Gender)\nEditProfileScreen\nCreateFlatScreen y RoomEditScreen\nForgotPasswordScreen y ResetPasswordScreen\nUsa KeyboardAwareScrollView o una soluci√≥n propia con KeyboardAvoidingView + ScrollView\nPantallas de registro: revisa el flujo completo de registro en un dispositivo peque√±o (320pt de ancho). Aseg√∫rate de que todos los elementos caben y son accesibles.\n\nProfileDetailScreen y RoomDetailScreen: verifica en m√∫ltiples tama√±os de pantalla que el layout es correcto, los carruseles de fotos funcionan, y los botones de acci√≥n no quedan cortados.\n\nForgotPasswordScreen y ResetPasswordScreen: corrige cualquier problema de layout. El formulario debe estar centrado verticalmente cuando no hay teclado y subir cuando el teclado aparece.\n\nSwipeScreen con estilos relativos: reemplaza todos los valores de posici√≥n y tama√±o hardcodeados en px por valores relativos (porcentajes de Dimensions.get('window')) para que las cards de swipe se vean bien en pantallas de distintos tama√±os.\n\nTabBar: verifica que la barra de navegaci√≥n inferior no queda cortada en dispositivos con notch inferior (iPhone con home indicator). Aplica paddingBottom con useSafeAreaInsets() si es necesario.\n\nMatchesScreen: ajusta el padding y spacing para que la lista de matches no tenga espacio excesivo ni insuficiente.\n\nPorcentajes de compatibilidad: si el porcentaje calculado puede salir de rango (< 0 o > 100), a√±ade un clamp para asegurar que siempre est√° entre 0 y 100.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:26:29.929Z",
      "updatedAt": "2026-02-18T13:26:29.929Z",
      "id": 10
    },
    {
      "title": "Sprint 16 ‚Äî Swipe Porcentual",
      "content": "Implementa un sistema de compatibilidad porcentual visible en las cards de swipe de HomiMatchApp.\n\nLo que debes implementar:\n\nC√°lculo de porcentaje de compatibilidad: crea una funci√≥n calculateCompatibility(userProfile, candidateProfile, userFilters) que devuelva un n√∫mero de 0 a 100. Factores a considerar (con pesos configurables):\n\nCoincidencia en rango de precio buscado\nCoincidencia de ciudad/zona\nCoincidencia de intereses (porcentaje de intereses en com√∫n)\nCompatibilidad de estilos de vida\nCoincidencia en tipo de usuario (tiene piso / busca piso)\nPreferencias de g√©nero del compa√±ero\nVisualizaci√≥n en cards de swipe: en cada card del SwipeScreen, a√±ade un badge o indicador visual que muestre el porcentaje de compatibilidad. Puede ser:\n\nUn badge circular en la esquina superior derecha con el n√∫mero y color (verde > 70%, amarillo 40-70%, rojo < 40%)\nUna barra de progreso en la parte inferior de la card\nSwipeScreenV2: crea una nueva versi√≥n del SwipeScreen que incorpore este sistema. Mant√©n la funcionalidad de swipe existente (gestos, botones de like/dislike) y a√±ade la compatibilidad. Usa el nombre SwipeScreenV2 o actualiza el existente si prefieres.\n\nMejoras en el algoritmo de recomendaciones (backend): ordena los candidatos devueltos por la Edge Function de recomendaciones por porcentaje de compatibilidad descendente, para que los m√°s compatibles aparezcan primero en el stack de swipe.\n\nCorrecciones en backend de matches: verifica que la l√≥gica de matches funciona correctamente con el nuevo sistema. Cuando ambos usuarios se dan like mutuamente, el match debe crearse correctamente y aparecer en MatchesScreen.\n\nOptimizaci√≥n de queries: si la query de perfiles candidatos hace demasiadas llamadas o es lenta, optim√≠zala con una query √∫nica que traiga todos los datos necesarios para calcular la compatibilidad.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:26:55.367Z",
      "updatedAt": "2026-02-18T13:26:55.367Z",
      "id": 11
    },
    {
      "title": "Sprint 17 ‚Äî Hotfixes",
      "content": "Corrige los errores cr√≠ticos detectados inmediatamente despu√©s del sprint de swipe porcentual.\n\nHotfixes a realizar:\n\nHotfix principal: identifica y corrige el error cr√≠tico que impide el funcionamiento correcto de alguna funcionalidad core. Revisa los logs de error y el comportamiento en los commits a2ec3d6 y 964a01a. Los s√≠ntomas m√°s probables son:\n\nEl porcentaje de compatibilidad no se calcula o muestra incorrectamente\nLas cards de swipe no cargan o se quedan en estado de carga infinita\nEl match no se crea cuando ambos usuarios se dan like\nLa navegaci√≥n falla despu√©s de un swipe\nVerifica regresiones: despu√©s de los cambios del Sprint 16, comprueba que las funcionalidades anteriores siguen funcionando:\n\nEl flujo de registro completo (4 fases)\nEl chat en tiempo real\nLas push notifications\nLa gesti√≥n de gastos\nCorrecciones de estabilidad: si hay crashes o comportamientos inesperados en producci√≥n derivados de los √∫ltimos sprints, corr√≠gelos con el menor impacto posible en el c√≥digo.\n\nNota: este sprint es de hotfixes urgentes. Mant√©n los cambios m√≠nimos y enfocados. No a√±adas funcionalidades nuevas.\n\n",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:27:10.877Z",
      "updatedAt": "2026-02-18T13:27:10.877Z",
      "id": 12
    },
    {
      "title": "Sprint 18 ‚Äî Filtros Mejorados y Google Auth",
      "content": "Mejora el sistema de filtros de b√∫squeda y completa la integraci√≥n con Google Sign-In en HomiMatchApp.\n\nLo que debes implementar:\n\nActualizaci√≥n completa de FiltersScreen:\n\nA√±ade todos los filtros relevantes que puedan faltar: rango de precio, n√∫mero de habitaciones, tipo de usuario (busca piso / tiene piso / ambos), ciudad, zona, rango de edad, g√©nero del compa√±ero\nMejora la UX de los filtros: usa sliders para rangos num√©ricos, chips para selecci√≥n m√∫ltiple, y toggles para opciones binarias\nA√±ade un bot√≥n \"Restablecer filtros\" que vuelva a los valores por defecto\nMuestra un contador de cu√°ntos filtros est√°n activos\nGuarda los filtros aplicados en AsyncStorage para que persistan entre sesiones\nPremiumContext: crea un contexto que gestione el estado premium del usuario. Por ahora, con l√≥gica b√°sica:\n\nisPremium: boolean (leer de Supabase, tabla profiles, campo is_premium)\npremiumFeatures: lista de features disponibles seg√∫n el plan\ncheckPremiumStatus(): refresca el estado desde el backend\nAlgunos filtros avanzados estar√°n marcados como premium (bloqueados para usuarios free, con un icono de candado y prompt de upgrade)\nMainNavigator anclado: corrige el problema de que el MainNavigator (con los tabs) se reinicia o \"salta\" en ciertas transiciones de navegaci√≥n. El navigator debe mantenerse montado y el estado de los tabs debe persistir correctamente.\n\nGoogle Authentication finalizada:\n\nCompleta el flujo de registro con Google: si el usuario se registra con Google y es la primera vez, ll√©valo al flujo de registro multi-fase para completar su perfil (nombre, fecha de nacimiento, g√©nero, ciudad)\nSi ya tiene cuenta con Google, haz login directo\nManeja el caso de que el email de Google ya est√© registrado con contrase√±a (mu√©strale un mensaje apropiado)\nCorrige cualquier error en GoogleSignInButton o en el servicio de auth de Google\nCorrecci√≥n en TabBarIcon: si los iconos de la barra de tabs tienen alg√∫n problema visual (tama√±o incorrecto, color que no respeta el tema, etc.), corr√≠gelo.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:27:27.266Z",
      "updatedAt": "2026-02-18T13:27:27.266Z",
      "id": 13
    },
    {
      "title": "Sprint 19 ‚Äî Realtime y Estilos de Vida",
      "content": "Extiende el sistema de tiempo real a todas las pantallas relevantes y a√±ade el campo de estilos de vida en los perfiles.\n\nLo que debes implementar:\n\nSupabase Realtime en todas las pantallas:\n\nFlatExpensesScreen: suscr√≠bete a cambios en flat_expenses del piso actual. Cuando se a√±ada o modifique un gasto, actualiza la lista autom√°ticamente sin recargar.\n\nFlatSettlementScreen: suscr√≠bete a cambios en flat_settlements. Cuando alguien salda una deuda, actualiza el resumen.\n\nMatchesScreen: ya tiene realtime para el orden de chats. A√±ade tambi√©n suscripci√≥n a nuevos matches para que aparezcan sin recargar la pantalla.\n\nRoomDetailScreen: suscr√≠bete a cambios en los miembros del piso (cuando alguien se une o sale).\n\nRoomManagementScreen: suscr√≠bete a cambios en las habitaciones y asignaciones.\n\nEn todos los casos: gestiona correctamente los canales (usar nombres √∫nicos por pantalla + ID de recurso) y cancela las suscripciones en el useEffect cleanup.\n\nCampo \"Estilos de vida\" en perfiles:\n\nA√±ade un campo lifestyle_habits (array de strings) a la tabla profiles en Supabase\nDefine un conjunto predeterminado de opciones: \"Madrugador\", \"Noct√°mbulo\", \"No fumador\", \"Fumador\", \"Deportista\", \"Tranquilo\", \"Sociable\", \"Trabajador desde casa\", \"Mascota\", etc.\nEn EditProfileScreen: a√±ade una secci√≥n de selecci√≥n de estilos de vida con chips (selecci√≥n m√∫ltiple, m√°ximo 5)\nEn ProfileDetailScreen: muestra los estilos de vida del usuario con iconos o emojis representativos\nIncluye los estilos de vida en el c√°lculo de compatibilidad del Sprint 16\nInicio de Dark Mode: prepara el terreno para el dark mode (Sprint 20):\n\nAseg√∫rate de que ThemeContext existe y tiene la estructura correcta para soportar dos temas\nIdentifica qu√© colores hardcodeados hay en los componentes que dificultar√°n el dark mode y ap√∫ntalos (no los arregles a√∫n, solo identif√≠calos)",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:27:42.877Z",
      "updatedAt": "2026-02-18T13:27:42.877Z",
      "id": 14
    },
    {
      "title": "Sprint 20 ‚Äî Dark Mode",
      "content": "Implementa el modo oscuro completo en toda la aplicaci√≥n HomiMatchApp.\n\nLo que debes implementar:\n\nSistema de temas en ThemeContext:\n\nDefine dos temas completos: lightTheme y darkTheme, cada uno con todas las variables de color necesarias: background, surface, surfaceVariant, primary, onPrimary, text, textSecondary, border, inputBackground, cardBackground, tabBar, etc.\nEl contexto expone: theme (objeto con los colores actuales), isDark (boolean), toggleTheme() (funci√≥n para cambiar)\nLa preferencia se persiste con AsyncStorage\nAl iniciar la app, carga la preferencia guardada (o detecta la preferencia del sistema con Appearance.getColorScheme())\nActualizaci√≥n de todos los estilos: recorre todas las pantallas y componentes. En lugar de usar colores hardcodeados, usa theme.background, theme.text, etc. desde el contexto:\n\nUsa const { theme } = useTheme() en cada pantalla\nLos archivos .styles.ts deben convertirse en funciones que reciben theme como par√°metro: const styles = (theme: Theme) => StyleSheet.create({...})\nAseg√∫rate de que el efecto glassmorphism funciona bien en ambos modos (ajusta la opacidad del blur seg√∫n el modo)\nPantallas prioritarias (empieza por estas):\n\nSwipeScreen: las cards deben verse bien en modo oscuro\nChatScreen y MatchesScreen: burbujas de chat y lista de matches\nProfileDetailScreen y RoomDetailScreen: fondos y textos\nLoginScreen y RegisterScreen: formularios de autenticaci√≥n\nPersistencia y transici√≥n:\n\nLa transici√≥n entre modos debe ser suave (no hay animaci√≥n requerida, pero el cambio no debe causar un flash blanco)\nEl tema seleccionado debe mantenerse al cerrar y reabrir la app\nToggle en la UI: a√±ade un switch de modo oscuro/claro en EditProfileScreen o en una pantalla de configuraci√≥n, accesible desde el tab de perfil.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:28:02.923Z",
      "updatedAt": "2026-02-18T13:28:02.923Z",
      "id": 15
    },
    {
      "title": "Sprint 21 ‚Äî Premium Features",
      "content": "Implementa la l√≥gica inicial de caracter√≠sticas premium con limitaciones para usuarios free.\n\nLo que debes implementar:\n\nPremiumContext completado (basado en el inicio del Sprint 18):\n\nCampo is_premium en tabla profiles de Supabase (boolean, default false)\nEl contexto se inicializa leyendo este campo al hacer login\nExpone: isPremium, swipesRemaining (para usuarios free), canUseFeature(featureName: string)\nLimitaciones para usuarios free:\n\nL√≠mite de swipes diarios: los usuarios free tienen un l√≠mite de, por ejemplo, 20 swipes al d√≠a. Al llegar al l√≠mite, el SwipeScreen muestra un mensaje \"Has alcanzado tu l√≠mite diario\" con un prompt de upgrade\nFiltros avanzados bloqueados: algunos filtros en FiltersScreen est√°n reservados para premium. Mu√©stralos con un icono de candado üîí y al intentar usarlos, muestra un modal de upgrade\nSin anuncios: (placeholder para monetizaci√≥n futura)\nValidaci√≥n de email mejorada (edge function auth-check-email):\n\nAntes de enviar el email de verificaci√≥n en el registro, verifica que el formato es v√°lido y que el dominio existe (DNS check b√°sico)\nSi el email parece inv√°lido, devuelve un error descriptivo antes de intentar crear el usuario en Supabase\nUI para features premium:\n\nCrea un componente PremiumBadge que se muestra junto a las features de pago\nCrea un modal o bottom sheet PremiumUpgradeModal con: descripci√≥n de los beneficios premium, bot√≥n \"Obtener Premium\" (que de momento puede navegar a una pantalla placeholder), y bot√≥n \"Cerrar\"\nEl modal se puede invocar desde cualquier parte de la app",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:28:18.345Z",
      "updatedAt": "2026-02-18T13:28:18.345Z",
      "id": 16
    },
    {
      "title": "Sprint 22 ‚Äî UI Dark Mode Refinamiento",
      "content": "Refina los detalles del modo oscuro y corrige problemas detectados tras la implementaci√≥n inicial.\n\nLo que debes corregir y mejorar:\n\nFormSection para ambos modos: el componente FormSection (usado en formularios de edici√≥n) debe adaptar sus colores al tema actual. Corrige el background del contenedor, el color del t√≠tulo de secci√≥n, y los bordes para que se vean bien tanto en claro como en oscuro.\n\nCorrecciones en m√∫ltiples pantallas: revisa en modo oscuro cada pantalla y corrige los elementos que no se adaptan correctamente:\n\nTextos blancos sobre fondo blanco (o negros sobre negro)\nInputs con fondo hardcodeado que no respeta el tema\nIconos con color fijo que no cambia con el tema\nBordes con colores hardcodeados\nModales y bottom sheets con fondo incorrecto\nOwner puede buscar owner: corrige el bug por el cual un usuario con tipo \"owner\" (tiene piso) no pod√≠a ver en sus recomendaciones a otros owners. La l√≥gica de recomendaciones debe permitir que un owner busque otro owner para intercambios o colaboraciones. Actualiza la Edge Function de recomendaciones para eliminar esta restricci√≥n incorrecta.\n\nSistema de perfil activo/inactivo:\n\nA√±ade campo is_active (boolean, default true) a la tabla profiles\nEn EditProfileScreen o en la configuraci√≥n, a√±ade un toggle \"Perfil activo\" que permita al usuario pausar su visibilidad en el swipe\nLos perfiles inactivos no aparecen en las recomendaciones de swipe\nCuando el perfil est√° inactivo, muestra un banner informativo en la app\nMerge y limpieza: despu√©s de las correcciones, aseg√∫rate de que no hay ramas de feature sin mergear y que el c√≥digo est√° limpio (sin console.logs de debug, sin c√≥digo comentado innecesario).",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:28:41.524Z",
      "updatedAt": "2026-02-18T13:28:41.524Z",
      "id": 17
    },
    {
      "title": "Sprint 23 ‚Äî Ciudades y Zonas",
      "content": "Implementa un sistema completo de ubicaciones geogr√°ficas con ciudades espa√±olas y zonas en HomiMatchApp.\n\nLo que debes crear:\n\nPoblaci√≥n de la base de datos con datos geogr√°ficos de Espa√±a:\n\nCrea scripts Python para extraer y normalizar datos de OpenStreetMap o fuentes p√∫blicas:\nextract_geojson.py: extrae ciudades/municipios de un archivo GeoJSON\nextract_places.py: extrae barrios/distritos de cada ciudad\nnormalize_areas.py: normaliza y limpia los nombres de zonas\nfilter_cities_by_places.py: filtra ciudades por n√∫mero m√≠nimo de barrios\nGenera SQLs de inserci√≥n masiva para las tablas cities y areas\nFoco en las ciudades m√°s grandes (Madrid, Barcelona, Valencia, Sevilla, Zaragoza, M√°laga, Murcia, Palma, Las Palmas, Bilbao...)\nTablas en Supabase:\n\ncities: id, name, province, autonomous_community, population, latitude, longitude\nareas: id, city_id, name, type (district/neighborhood)\nEdge Function locations:\n\nGET /cities: lista de ciudades (con b√∫squeda por nombre)\nGET /cities/:cityId/areas: zonas de una ciudad\nGET /cities/nearby: ciudades cercanas a una coordenada (para el boost por proximidad)\nServicio locationService:\n\nsearchCities(query: string): busca ciudades por nombre\ngetAreasForCity(cityId: string): obtiene las zonas de una ciudad\ngetNearbyCities(cityId: string, radiusKm: number): ciudades cercanas\nIntegraci√≥n en perfiles:\n\nEn EditProfileScreen: sustituye el campo de ciudad libre por un selector de ciudad con b√∫squeda autocomplete, y un selector de zona/barrio dependiente de la ciudad elegida\nCampo preferred_city_id y preferred_area_id en profiles\nIntegraci√≥n en pisos:\n\nEn CreateFlatScreen y RoomEditScreen: selector de ciudad y zona para el piso\nCampo city_id y area_id en la tabla de pisos\nFiltros por ubicaci√≥n:\n\nEn FiltersScreen: selector de ciudad y zona\nLa Edge Function de recomendaciones filtra por ciudad (y opcionalmente por zona)\nLas ciudades cercanas reciben una penalizaci√≥n menor en lugar de excluirse completamente\nFunci√≥n \"Borrar perfil\": a√±ade opci√≥n en la configuraci√≥n del perfil para eliminar permanentemente la cuenta. Muestra un di√°logo de confirmaci√≥n con texto de advertencia. Al confirmar, elimina los datos del usuario de Supabase Auth y de la tabla profiles (y en cascada sus datos relacionados).\n\nKeyboardAwareContainer (componente reutilizable): crea un componente wrapper que gestione autom√°ticamente el comportamiento del teclado en cualquier pantalla. √ösalo en todas las pantallas con formularios como sustituto de las soluciones individuales de sprints anteriores.",
      "category": "feature",
      "targetScenarios": [
        "A",
        "B",
        "C",
        "D"
      ],
      "notes": "",
      "createdAt": "2026-02-18T13:29:12.682Z",
      "updatedAt": "2026-02-18T13:29:12.682Z",
      "id": 18
    }
  ],
  "promptEvaluations": [],
  "exportedAt": "2026-02-18T13:29:50.391Z"
}